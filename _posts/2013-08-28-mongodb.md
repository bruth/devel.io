---
published: false
layout: post
title: MongoDB
summary: Notes on learning MongoDB from a relational database perspective.
---

### Schemas

- The [schema](http://en.wikipedia.org/wiki/Database_schema) vs. schemaless argument boils down to whether the database system requires a _predefined_ schema
- Data that _is_ schemaless could be a nightware to work with
- If not explicitly defined, most data have a natural schema
- Shoving any and all data into a single target (e.g. a MongoDB collection) is roughly equivalent to writing all that data to a text file. It will have to be parsed for it to be useable.

#### Flexibility

- Every document in a single collection _could_ be different
- Collections are _dumb_ since each document holds the information about it's own _schema_
	- This also comes with a lot of redundancy in a collection is _regular_
- Databases and collections are created _on-the-fly_ which makes it simple for automatic loading of random bits of data from different sources
	- Which them could be consolidated later


### Terminology

- **database** - Exist within a Mongo instance.
- **collection** - Exist within a database and are conceptually equivalent to tables in a relational database.
- **document** - Exist within a collection and are conceptually equivalent to rows in a relational database.
- **field** - Defined on a document and are conceptually equivalent to columns in a relational database.
- **index** - Defined on collections and are conceptually equivalent to indexes in a relational database.
- **cursor** - Primary interface to the data. This is the same as with relational database drivers.

### Use Cases

- Storage for _longer_-term cache when something like [memcached](memcached.org) is too volatile or data structures are needed
- Intermediate or staging storage for [ETL](http://en.wikipedia.org/wiki/Extract,_transform,_load)

### Details

- BSON is the internal storage format, JSON is the API layer format
- `db.system.indexes` is created (implicitly) once per database to store information about indexes
- Every document has a `_id` field generated if one is not supplied
- The `_id` field is indexed per collection

### Selectors

- Similiar to the `WHERE` clause in SQL
- Use the `find()` method on a collection, e.g. `db.people.find(...)`
- Arrays are traversed implicitly
- Selectors are specified as JavaScript objects themselves, e.g. `{age: {$gt: 10}}`
- `{}` selector matches all documents
- Few common ones
	- exact match does not use an operator, e.g. `{middle_name: 'James'}`
    - `$ne` - not equal
	- `$exists` - presence/absence of a field, e.g. `{middle_name: {$exists: true}}`
    - `$lt`, `$lte`, `$gt`, `$gte` - numerical operators
    - `$or` - groups conditions for a logical OR rather than AND, e.g. `{$or: [{$color: 'blue'}, {$color: 'red'}]}`

### References

- [The Little MongoDB Book](http://openmymind.net/2011/3/28/The-Little-MongoDB-Book/) by Karl Seguin
- [MongoDB Manual](http://docs.mongodb.org/manual/) (of course)
- [MongoDB Reference Cards](http://www.mongodb.com/reference)
- [MongoDB Presentations](http://www.mongodb.com/presentations)